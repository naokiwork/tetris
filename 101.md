# 改善点リスト 101

このドキュメントには、テトリスアプリケーションの修正案、改善案、機能改善、バグ修正をまとめています。

## 📝 修正案（5個）

### 1. ゲーム開始時のアニメーション追加
**場所**: `src/main.ts:36`
- ゲーム開始時に視覚的なフィードバックがない
- **修正**: ゲーム開始時にカウントダウンアニメーション（3, 2, 1, GO!）を表示し、ゲームの開始を明確にする

### 2. ライン消去時のエフェクト強化
**場所**: `src/board.ts:85`
- ライン消去時の視覚効果が限定的
- **修正**: ライン消去時にパーティクルエフェクトやフラッシュエフェクトを追加し、より視覚的に分かりやすくする

### 3. ピース回転時の音響フィードバック
**場所**: `src/game.ts:200`
- ピース回転時に視覚的なフィードバックのみ
- **修正**: ピース回転時に音響フィードバックを追加（Web Audio APIを使用）。回転成功/失敗で異なる音を再生

### 4. ゲーム速度の視覚的表示
**場所**: `src/renderer.ts:240`
- 現在のゲーム速度が数値で表示されていない
- **修正**: ゲーム速度（落下間隔）を視覚的に表示するインジケーターを追加。レベルと連動して色が変わる

### 5. キー入力の視覚的フィードバック
**場所**: `src/input.ts:52`
- キー入力時に視覚的なフィードバックがない
- **修正**: キー入力時に画面に短時間表示されるインジケーターを追加。どのキーが押されたかを表示

## 💡 改善案（5個）

### 6. ゲーム統計の詳細表示
**場所**: `src/score.ts:1`
- 現在の統計情報が限定的
- **修正**: 平均スコア、最高レベル、総プレイ時間、総消去ライン数などの詳細統計を表示する画面を追加

### 7. カスタムテーマ機能
**場所**: `styles/main.css:1`
- テーマが固定されている
- **修正**: 複数のテーマ（ダーク、ライト、カラフル等）を選択できる機能を追加。テーマはlocalStorageに保存

### 8. リプレイ機能の拡張
**場所**: `新規実装`
- リプレイ機能がない
- **修正**: ゲームの操作を記録し、後でリプレイできる機能を実装。リプレイ時は操作を再現し、スピード調整も可能

### 9. チュートリアルモード
**場所**: `新規実装`
- 初心者向けのガイドがない
- **修正**: 段階的なチュートリアルモードを実装。基本的な操作から高度なテクニックまで、インタラクティブに学習できる

### 10. ランキング機能
**場所**: `新規実装`
- スコアの比較機能がない
- **修正**: ローカルストレージを使用したランキング機能を実装。トップ10のスコアを表示し、名前を入力して記録できる

## 🚀 機能改善（5個）

### 11. マルチプレイヤーモード（ローカル）
**場所**: `新規実装`
- 現在はシングルプレイヤーのみ
- **修正**: 同じ画面で2人対戦できるローカルマルチプレイヤーモードを実装。左右に分割された画面で同時にプレイ

### 12. カスタムボードサイズ
**場所**: `src/types.ts:20`
- ボードサイズが固定されている
- **修正**: 設定画面でボードサイズをカスタマイズできる機能を追加（例: 8×16、10×20、12×24）。難易度に応じて選択可能

### 13. ピースの色カスタマイズ
**場所**: `src/types.ts:30`
- ピースの色が固定されている
- **修正**: 設定画面で各ピースの色をカスタマイズできる機能を追加。カラーピッカーを使用し、色覚多様性にも配慮

### 14. ゲームモードの追加
**場所**: `src/game.ts:1`
- 通常モードのみ
- **修正**: スプリントモード（40ラインを最速で消去）、マラソンモード（長時間プレイ）などのゲームモードを追加

### 15. オートプレイ機能
**場所**: `新規実装`
- デモンストレーション機能がない
- **修正**: AIまたはアルゴリズムによる自動プレイ機能を実装。デモンストレーションや学習目的で使用可能

## 🐛 バグ修正（5個）

### 16. ピースが画面外に表示される問題
**場所**: `src/pieces.ts:63`
- 特定の条件下でピースが画面外に表示される
- **修正**: ピースの出現位置を検証し、常に画面内に収まるようにする。特にIピースの横長形状に注意

### 17. ホールド機能の状態リセット問題
**場所**: `src/game.ts:211`
- ゲーム再開時にホールド機能の状態が正しくリセットされない場合がある
- **修正**: `start`メソッドでホールド関連の状態を確実にリセットする処理を追加

### 18. スコア表示の更新タイミング問題
**場所**: `src/renderer.ts:240`
- スコアが更新されても表示が即座に反映されない場合がある
- **修正**: スコア更新時に確実にUIを更新する処理を追加。requestAnimationFrameを使用

### 19. ゲームループの停止処理
**場所**: `src/main.ts:101`
- ゲームループが完全に停止しない場合がある
- **修正**: `stop`メソッドで確実にすべての処理を停止する。イベントリスナーの削除も確実に実行

### 20. メモリ使用量の最適化
**場所**: `src/renderer.ts:49`
- 長時間プレイするとメモリ使用量が増加する可能性がある
- **修正**: 不要なオブジェクトの参照を削除し、ガベージコレクションを促進。WeakMapの使用を検討

---

**作成日**: 2024-11-23
**更新日**: 2024-11-23
**総項目数**: 20個（修正案5個、改善案5個、機能改善5個、バグ修正5個）
